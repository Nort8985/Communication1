<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π –∏ –æ–±—â–µ–Ω–∏—è">
    <meta name="theme-color" content="#0079d3">

    <!-- PWA –ú–∞–Ω–∏—Ñ–µ—Å—Ç -->
    <link rel="manifest" href="manifest.json">

    <!-- –ò–∫–æ–Ω–∫–∏ –¥–ª—è PWA -->
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="icons/icon-512x512.png">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <title>DevTalk - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏–π</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Service Worker –¥–ª—è PWA -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then((registration) => {
                        console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration);
                    })
                    .catch((error) => {
                        console.log('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
                    });
            });
        }
    </script>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notifications" class="notifications"></div>

    <!-- –ù–∞–≤–±–∞—Ä -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-left">
                <button class="mobile-menu-btn" onclick="toggleMobileMenu()" title="–ú–µ–Ω—é">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo" onclick="scrollToTop()">
                    <i class="fas fa-comments"></i>
                    <span>DevTalk</span>
                </div>
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="search-input" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ø–æ—Å—Ç–∞–º, –∞–≤—Ç–æ—Ä–∞–º, —Ç–µ–≥–∞–º..." onkeydown="handleSearch(event)">
                    <div class="search-suggestions" id="search-suggestions"></div>
                </div>
            </div>
            <div class="nav-center">
                <div class="nav-stats">
                    <span class="stat-item" title="–ü–æ—Å—Ç–æ–≤ —Å–µ–≥–æ–¥–Ω—è">
                        <i class="fas fa-file-alt"></i>
                        <span id="today-posts">0</span>
                    </span>
                    <span class="stat-item" title="–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π">
                        <i class="fas fa-users"></i>
                        <span id="active-users">0</span>
                    </span>
                </div>
            </div>
            <div class="nav-right">
                <button class="icon-btn" onclick="toggleTheme()" title="–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É">
                    <i class="fas fa-moon" id="theme-icon"></i>
                </button>
                <div class="notification-btn" onclick="toggleNotifications()">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="notification-badge">0</span>
                </div>
                <div class="online-badge">
                    <i class="fas fa-circle"></i>
                    <span id="online-count">0</span>
                </div>
                <button class="create-post-btn-nav" onclick="openPostModal()" title="–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç">
                    <i class="fas fa-plus"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
    <div class="mobile-overlay" onclick="toggleMobileMenu()"></div>
    <div class="mobile-sidebar" id="mobile-sidebar">
        <div class="mobile-sidebar-header">
            <h3><i class="fas fa-bars"></i> –ú–µ–Ω—é</h3>
            <button class="close-btn" onclick="toggleMobileMenu()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="mobile-sidebar-content">
            <!-- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ -->
            <div class="sidebar-card">
                <h3><i class="fas fa-fire"></i> –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h3>
                <div class="sort-buttons">
                    <button class="sort-btn active" onclick="sortPosts('new'); toggleMobileMenu();">
                        <i class="fas fa-clock"></i> –ù–æ–≤—ã–µ
                    </button>
                    <button class="sort-btn" onclick="sortPosts('hot'); toggleMobileMenu();">
                        <i class="fas fa-fire"></i> –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ
                    </button>
                    <button class="sort-btn" onclick="sortPosts('top'); toggleMobileMenu();">
                        <i class="fas fa-arrow-up"></i> –¢–æ–ø
                    </button>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="sidebar-card info-card">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div class="stat-item">
                    <span>–ü–æ—Å—Ç–æ–≤:</span>
                    <strong id="posts-count-mobile">0</strong>
                </div>
                <div class="stat-item">
                    <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
                    <strong id="users-count-mobile">0</strong>
                </div>
                <div class="stat-item">
                    <span>–û–Ω–ª–∞–π–Ω:</span>
                    <strong id="online-count-mobile">0</strong>
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∏–ª–∞ -->
            <div class="sidebar-card rules-card">
                <h3>üìú –ü—Ä–∞–≤–∏–ª–∞</h3>
                <ol>
                    <li>–ë—É–¥—å—Ç–µ –≤–µ–∂–ª–∏–≤—ã</li>
                    <li>–ù–µ —Å–ø–∞–º—å—Ç–µ</li>
                    <li>–ù–∏–∫–∞–∫–æ–≥–æ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è</li>
                    <li>–°–æ–±–ª—é–¥–∞–π—Ç–µ —Ç–µ–º—É</li>
                </ol>
            </div>

            <!-- –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ -->
            <div class="sidebar-card" id="admin-sidebar-mobile" style="display: none;">
                <button class="admin-btn" onclick="openAdminPanel(); toggleMobileMenu();">
                    <i class="fas fa-shield-alt"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                </button>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∏–∫–∞ -->
            <div class="sidebar-card">
                <h3><i class="fas fa-user-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <div class="settings-actions">
                    <button class="settings-btn clear-username" onclick="clearSavedUsername(); toggleMobileMenu();">
                        <i class="fas fa-user-times"></i> –û—á–∏—Å—Ç–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –Ω–∏–∫
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
    <div class="main-container">
        <!-- –õ–µ–≤—ã–π —Å–∞–π–¥–±–∞—Ä -->
        <aside class="left-sidebar">
            <div class="sidebar-card">
                <h3><i class="fas fa-fire"></i> –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞</h3>
                <div class="sort-buttons">
                    <button class="sort-btn active" onclick="sortPosts('new')">
                        <i class="fas fa-clock"></i> –ù–æ–≤—ã–µ
                    </button>
                    <button class="sort-btn" onclick="sortPosts('hot')">
                        <i class="fas fa-fire"></i> –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ
                    </button>
                    <button class="sort-btn" onclick="sortPosts('top')">
                        <i class="fas fa-arrow-up"></i> –¢–æ–ø
                    </button>
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ -->
            <div class="sidebar-card" id="admin-sidebar" style="display: none;">
                <button class="admin-btn" onclick="openAdminPanel()">
                    <i class="fas fa-shield-alt"></i> –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å
                </button>
            </div>
        </aside>

        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <main class="content">
            <div class="create-post-card">
                <div class="user-avatar">
                    <i class="fas fa-user-circle"></i>
                </div>
                <input type="text" id="username" placeholder="–í–∞—à–µ –∏–º—è" maxlength="20" class="username-input">
                <button class="create-post-btn" onclick="openPostModal()">
                    <i class="fas fa-plus"></i> –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç
                </button>
            </div>

            <div id="posts-container"></div>
        </main>

        <!-- –ü—Ä–∞–≤—ã–π —Å–∞–π–¥–±–∞—Ä -->
        <aside class="right-sidebar">
            <div class="sidebar-card info-card">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div class="stat-item">
                    <span>–ü–æ—Å—Ç–æ–≤:</span>
                    <strong id="posts-count">0</strong>
                </div>
                <div class="stat-item">
                    <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</span>
                    <strong id="users-count">0</strong>
                </div>
                <div class="stat-item">
                    <span>–û–Ω–ª–∞–π–Ω:</span>
                    <strong id="online-count-sidebar">0</strong>
                </div>
            </div>

            <div class="sidebar-card rules-card">
                <h3>üìú –ü—Ä–∞–≤–∏–ª–∞</h3>
                <ol>
                    <li>–ë—É–¥—å—Ç–µ –≤–µ–∂–ª–∏–≤—ã</li>
                    <li>–ù–µ —Å–ø–∞–º—å—Ç–µ</li>
                    <li>–ù–∏–∫–∞–∫–æ–≥–æ –æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è</li>
                    <li>–°–æ–±–ª—é–¥–∞–π—Ç–µ —Ç–µ–º—É</li>
                </ol>
            </div>
        </aside>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞ -->
    <div id="post-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</h2>
                <button class="close-btn" onclick="closePostModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <input type="text" id="post-title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–æ—Å—Ç–∞" maxlength="100" class="post-title-input">
                <textarea id="post-text" placeholder="–¢–µ–∫—Å—Ç –ø–æ—Å—Ç–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)" rows="6" class="post-text-input"></textarea>
                <div class="modal-actions">
                    <button class="cancel-btn" onclick="closePostModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button class="submit-btn" onclick="submitPost()">
                        <i class="fas fa-paper-plane"></i> –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ -->
    <div id="admin-modal" class="admin-modal">
        <div class="admin-modal-content">
            <div class="admin-modal-header">
                <h2><i class="fas fa-shield-alt"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h2>
                <button class="close-btn" onclick="closeAdminPanel()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
            <div class="admin-nav">
                <button class="admin-nav-btn active" onclick="switchAdminTab('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>–ü–∞–Ω–µ–ª—å</span>
                </button>
                <button class="admin-nav-btn" onclick="switchAdminTab('online')">
                    <i class="fas fa-users"></i>
                    <span>–û–Ω–ª–∞–π–Ω</span>
                    <span class="badge" id="badge-online">0</span>
                </button>
                <button class="admin-nav-btn" onclick="switchAdminTab('users')">
                    <i class="fas fa-user-friends"></i>
                    <span>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</span>
                </button>
                <button class="admin-nav-btn" onclick="switchAdminTab('bans')">
                    <i class="fas fa-ban"></i>
                    <span>–ë–∞–Ω—ã</span>
                    <span class="badge badge-danger" id="badge-bans">0</span>
                </button>
                <button class="admin-nav-btn" onclick="switchAdminTab('mutes')">
                    <i class="fas fa-volume-mute"></i>
                    <span>–ú—É—Ç—ã</span>
                    <span class="badge badge-warning" id="badge-mutes">0</span>
                </button>
                <button class="admin-nav-btn" onclick="switchAdminTab('posts')">
                    <i class="fas fa-list"></i>
                    <span>–ü–æ—Å—Ç—ã</span>
                </button>
            </div>

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
            <div class="admin-content">
                
                <!-- –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
                <div id="admin-tab-dashboard" class="admin-tab-pane active">
                    <h3>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                    <div class="stats-grid">
                        <div class="stat-box">
                            <div class="stat-icon" style="background: #4CAF50;">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                                <div class="stat-value" id="stat-users">0</div>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon" style="background: #2196F3;">
                                <i class="fas fa-circle"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">–û–Ω–ª–∞–π–Ω —Å–µ–π—á–∞—Å</div>
                                <div class="stat-value" id="stat-online">0</div>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon" style="background: #FF9800;">
                                <i class="fas fa-comments"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">–í—Å–µ–≥–æ –ø–æ—Å—Ç–æ–≤</div>
                                <div class="stat-value" id="stat-posts">0</div>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon" style="background: #F44336;">
                                <i class="fas fa-ban"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –±–∞–Ω–æ–≤</div>
                                <div class="stat-value" id="stat-bans">0</div>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon" style="background: #9C27B0;">
                                <i class="fas fa-volume-mute"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö –º—É—Ç–æ–≤</div>
                                <div class="stat-value" id="stat-mutes">0</div>
                            </div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-icon" style="background: #00BCD4;">
                                <i class="fas fa-heart"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-label">–í—Å–µ–≥–æ –ª–∞–π–∫–æ–≤</div>
                                <div class="stat-value" id="stat-likes">0</div>
                            </div>
                        </div>
                    </div>

                    <h3 style="margin-top: 30px;">üî• –ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
                    <div id="recent-activity"></div>
                </div>

                <!-- –û–ù–õ–ê–ô–ù –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò -->
                <div id="admin-tab-online" class="admin-tab-pane">
                    <div class="tab-header">
                        <h3><i class="fas fa-circle" style="color: #46d160;"></i> –û–Ω–ª–∞–π–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <button class="refresh-btn" onclick="refreshOnlineUsers()">
                            <i class="fas fa-sync-alt"></i> –û–±–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                    <div id="online-users-list"></div>
                </div>

                <!-- –í–°–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ò -->
                <div id="admin-tab-users" class="admin-tab-pane">
                    <div class="tab-header">
                        <h3><i class="fas fa-user-friends"></i> –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <input type="text" id="search-users" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è..." class="search-input">
                    </div>
                    <div id="all-users-list"></div>
                </div>

                <!-- –ë–ê–ù–´ -->
                <div id="admin-tab-bans" class="admin-tab-pane">
                    <div class="tab-header">
                        <h3><i class="fas fa-ban"></i> –ó–∞–±–∞–Ω–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <div class="header-actions">
                            <button class="action-btn" onclick="clearExpiredBans()">
                                <i class="fas fa-broom"></i> –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–µ–∫—à–∏–µ
                            </button>
                        </div>
                    </div>
                    <div id="bans-list"></div>
                </div>

                <!-- –ú–£–¢–´ -->
                <div id="admin-tab-mutes" class="admin-tab-pane">
                    <div class="tab-header">
                        <h3><i class="fas fa-volume-mute"></i> –ó–∞–º—É—á–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                        <div class="header-actions">
                            <button class="action-btn" onclick="clearExpiredMutes()">
                                <i class="fas fa-broom"></i> –û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–µ–∫—à–∏–µ
                            </button>
                        </div>
                    </div>
                    <div id="mutes-list"></div>
                </div>

                <!-- –ü–û–°–¢–´ -->
                <div id="admin-tab-posts" class="admin-tab-pane">
                    <div class="tab-header">
                        <h3><i class="fas fa-list"></i> –í—Å–µ –ø–æ—Å—Ç—ã</h3>
                        <input type="text" id="search-posts" placeholder="–ü–æ–∏—Å–∫ –ø–æ –ø–æ—Å—Ç–∞–º..." class="search-input">
                    </div>
                    <div id="all-posts-list"></div>
                </div>

            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@fingerprintjs/fingerprintjs@3/dist/fp.min.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>
